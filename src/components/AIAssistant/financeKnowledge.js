// Finance Knowledge Base for AI Assistant

export const financeKnowledge = {
  // Budgeting advice
  budgeting: {
    general: [
      "Try to follow the 50/30/20 rule: 50% for necessities, 30% for wants, and 20% for savings.",
      "Track every expense to identify spending patterns and areas to cut back.",
      "Consider using the envelope method for discretionary spending.",
      "Review your budget regularly and adjust as needed.",
      "Use the categories in this app to track your spending by category and identify trends."
    ],
    methods: [
      "Zero-based budgeting: Give every dollar a purpose before you spend it.",
      "50/30/20 budget: Allocate 50% to needs, 30% to wants, and 20% to savings and debt repayment.",
      "Envelope system: Divide cash into envelopes for different spending categories.",
      "Pay-yourself-first budget: Set aside savings before spending on anything else.",
      "Values-based budgeting: Prioritize spending on what matters most to you."
    ],
    challenges: [
      "For inconsistent income, budget based on your minimum monthly income and treat extra as a bonus.",
      "For high debt, consider the debt avalanche method (paying highest interest first) or snowball method (smallest balance first).",
      "For impulse spending, try implementing a 24-hour rule before making non-essential purchases.",
      "For shared finances, have open conversations and consider both joint and individual accounts.",
      "For seasonal expenses, set up sinking funds to save a little each month for holidays, insurance, etc."
    ]
  },
  
  // Saving advice
  saving: {
    general: [
      "Set up automatic transfers to your savings account on payday.",
      "Try to save at least 20% of your income for future goals and emergencies.",
      "Maintain an emergency fund covering 3-6 months of expenses.",
      "Consider high-yield savings accounts for better returns on your emergency fund."
    ],
    emergencyFund: [
      "Aim for 3-6 months of essential expenses in your emergency fund.",
      "Keep your emergency fund in a liquid, easily accessible account.",
      "Start small – even $500-$1000 can help in many emergencies.",
      "Replenish your emergency fund as soon as possible after using it."
    ],
    savingGoals: [
      "Break large saving goals into smaller milestones.",
      "Use separate accounts for different savings goals.",
      "Automate savings for your goals to maintain consistency.",
      "Consider certificates of deposit (CDs) for short to medium-term goals.",
      "Review and adjust your saving goals regularly."
    ],
    savingTips: [
      "Save windfalls like tax refunds, bonuses, or gifts instead of spending them.",
      "Try a no-spend challenge for a week or month to boost savings.",
      "Use cashback apps and credit cards (if paid in full monthly) to earn on necessary purchases.",
      "Negotiate bills and subscriptions annually to reduce recurring expenses.",
      "Consider downsizing in high-expense areas like housing or transportation."
    ]
  },
  
  // Investing advice
  investing: {
    general: [
      "Start investing early to take advantage of compound interest.",
      "Diversify your investments across different asset classes.",
      "Consider low-cost index funds for long-term growth.",
      "Regularly review and rebalance your investment portfolio."
    ],
    beginners: [
      "Start with index funds or ETFs that track broad markets like the S&P 500.",
      "Consider a robo-advisor for an automated, low-cost investment approach.",
      "Use tax-advantaged accounts like IRAs or 401(k)s before taxable accounts.",
      "Keep investment costs low – look for expense ratios under 0.2% for passive funds.",
      "Dollar-cost averaging (investing a fixed amount regularly) helps reduce timing risk."
    ],
    strategy: [
      "Your asset allocation should align with your time horizon and risk tolerance.",
      "A common rule is to subtract your age from 110 to get your equity percentage.",
      "Rebalance your portfolio at least annually to maintain your target allocation.",
      "Don't try to time the market – consistent investing typically outperforms.",
      "Consider automatic portfolio rebalancing if available through your investment platform."
    ],
    retirement: [
      "Maximize employer matching in retirement accounts – it's free money.",
      "Consider a mix of traditional (pre-tax) and Roth (post-tax) retirement accounts.",
      "If self-employed, look into SEP IRAs, Solo 401(k)s, or SIMPLE IRAs.",
      "The Rule of 72: Divide 72 by your expected return rate to estimate how long it will take to double your money.",
      "Consider a target-date fund for a one-stop retirement investment solution."
    ]
  },
  
  // Debt management advice
  debt: {
    general: [
      "Focus on paying off high-interest debt first (debt avalanche method).",
      "Consider the debt snowball method to build momentum by paying smallest debts first.",
      "Avoid taking on new debt while paying off existing obligations.",
      "Look into debt consolidation options if you have multiple high-interest debts."
    ],
    creditCard: [
      "Always pay more than the minimum payment on credit cards.",
      "Consider balance transfer offers for high-interest credit card debt.",
      "Call your credit card company to negotiate a lower interest rate.",
      "Avoid using credit cards for everyday expenses while paying off debt.",
      "Consider a debt consolidation loan at a lower interest rate than your cards."
    ],
    studentLoans: [
      "Look into income-driven repayment plans for federal student loans.",
      "Check if you qualify for student loan forgiveness programs.",
      "Consider refinancing private student loans if you can get a lower interest rate.",
      "Make biweekly instead of monthly payments to reduce interest and pay off faster.",
      "Apply any windfalls directly to student loan principal to reduce total interest."
    ],
    mortgage: [
      "Consider refinancing if you can lower your interest rate by at least 0.5-1%.",
      "Making one extra payment per year can significantly reduce your mortgage term.",
      "Biweekly payments (half your monthly payment every two weeks) result in an extra payment annually.",
      "Look into mortgage recasting if you can make a large principal payment.",
      "Avoid extending your mortgage term when refinancing if possible."
    ],
    debtFree: [
      "Once debt-free, redirect former debt payments to building savings and investments.",
      "Consider keeping older credit accounts open to maintain your credit history length.",
      "Use credit cards responsibly for credit-building and rewards, paying in full each month.",
      "Review your credit report annually to ensure accuracy and monitor your progress.",
      "Celebrate becoming debt-free, but maintain the good habits that got you there."
    ]
  },
  
  // Tax advice
  taxes: {
    general: [
      "Keep track of tax-deductible expenses throughout the year.",
      "Consider tax-advantaged investment accounts like IRAs or 401(k)s.",
      "Review potential tax credits and deductions you might qualify for.",
      "Consider consulting a tax professional for complex situations."
    ],
    deductions: [
      "Common deductions include mortgage interest, charitable donations, and medical expenses.",
      "Self-employed individuals can deduct business expenses, home office costs, and health insurance premiums.",
      "Educational expenses may be deductible through the Lifetime Learning Credit or American Opportunity Credit.",
      "Keep detailed records and receipts for all potential deductions.",
      "Consider bunching deductions in alternate years if you're close to the standard deduction amount."
    ],
    taxPlanning: [
      "Contribute to pre-tax retirement accounts to reduce your current taxable income.",
      "Consider tax-loss harvesting in investment accounts to offset capital gains.",
      "Roth conversions in lower-income years can reduce future tax liability.",
      "Contribute to HSAs for triple tax advantages if you have a high-deductible health plan.",
      "Charitable donations of appreciated assets can avoid capital gains taxes."
    ],
    filing: [
      "File electronically for faster processing and refunds.",
      "Consider using tax software or a professional if your situation is complex.",
      "Check if you qualify for free filing through the IRS Free File program.",
      "Double-check all numbers and information before submitting your return.",
      "File on time or request an extension to avoid penalties."
    ]
  },
  
  // Retirement advice
  retirement: {
    general: [
      "Start saving for retirement as early as possible.",
      "Take advantage of employer matching in retirement plans.",
      "Consider diversifying retirement savings between traditional and Roth accounts.",
      "Increase retirement contributions when you get a raise or bonus."
    ],
    planning: [
      "Aim to replace 70-80% of your pre-retirement income during retirement.",
      "The 4% rule suggests you can withdraw 4% of your portfolio in year one, then adjust for inflation annually.",
      "Consider working with a financial advisor to create a comprehensive retirement plan.",
      "Account for healthcare costs, which average $300,000 per couple during retirement.",
      "Plan for different phases of retirement – early retirement may have higher expenses than later years."
    ],
    accounts: [
      "401(k)s and 403(b)s: Maximize employer matching and consider increasing contributions annually.",
      "Traditional IRAs offer tax-deductible contributions and tax-deferred growth.",
      "Roth IRAs provide tax-free withdrawals in retirement if you meet requirements.",
      "SEP IRAs and Solo 401(k)s are excellent options for self-employed individuals.",
      "HSAs can function as retirement accounts with triple tax advantages for medical expenses."
    ],
    lateStart: [
      "Maximize catch-up contributions after age 50 in retirement accounts.",
      "Consider working a few years longer to significantly increase retirement security.",
      "Delay Social Security benefits if possible – each year of delay increases benefits by about 8%.",
      "Focus on reducing debt before retirement to lower your income needs.",
      "Look into part-time work during early retirement to reduce portfolio withdrawals."
    ]
  },
  
  // App usage help
  appHelp: {
    general: [
      "Add transactions by clicking the 'Add Income' or 'Add Expense' buttons on the dashboard.",
      "View your financial overview on the Dashboard with income, expenses, and balance.",
      "Filter and search transactions using the tools above the transaction table.",
      "Export your transactions to CSV using the 'Export to CSV' button.",
      "Import transactions from a CSV file using the 'Import from CSV' button."
    ],
    transactions: [
      "Click 'Add Income' or 'Add Expense' on the dashboard to record a new transaction.",
      "Use appropriate tags to categorize transactions for better tracking.",
      "Filter transactions by type (income/expense) or search by name in the transaction table.",
      "Sort transactions by date or amount using the sort options above the table.",
      "View recent transactions directly on your dashboard under the transaction history section."
    ],
    reporting: [
      "The dashboard shows your current balance, total income, and total expenses.",
      "The 'Financial Statistics' chart displays your balance trend over time.",
      "The 'Total Spending' pie chart breaks down your expenses by category.",
      "Use the date filters to view transactions from specific time periods.",
      "Export your transaction data to analyze in spreadsheet software if needed."
    ],
    categories: [
      "Choose from multiple income categories including Salary, Business, Investments, and more.",
      "Expense categories are grouped by type: Daily Living, Lifestyle, Health & Education, etc.",
      "Use consistent categories to get better insights from the spending breakdown chart.",
      "Filter transactions by category using the dropdown menu above the transaction table.",
      "The colored tags in the transaction list help you quickly identify different categories."
    ],
    dataManagement: [
      "Import multiple transactions at once using a CSV file with the 'Import from CSV' button.",
      "Export your transaction history to back up your data or analyze elsewhere.",
      "Your data is securely stored and synced with your account.",
      "Regular transaction entry helps maintain accurate financial insights.",
      "Use the search function to quickly find specific transactions."
    ]
  },

  savingsAdvice: {
    emergency: [
      "Aim to save 3-6 months of living expenses for emergencies",
      "Keep emergency funds in easily accessible accounts",
      "Start small - even ₹500 per month helps build your emergency fund",
      "Automate your emergency fund contributions",
      "Review and adjust your emergency fund as your expenses change"
    ],
    general: [
      "Follow the 50/30/20 rule: 50% needs, 30% wants, 20% savings",
      "Set up automatic transfers to your savings account",
      "Look for high-yield savings accounts",
      "Save windfalls like bonuses and tax refunds",
      "Challenge yourself to no-spend days or weeks"
    ],
    retirement: [
      "Start retirement savings early to benefit from compound interest",
      "Maximize your employer's retirement contribution match if available",
      "Consider diversifying retirement savings across different accounts",
      "Increase retirement contributions when you get a raise",
      "Review and rebalance retirement portfolios annually"
    ]
  },

  investmentAdvice: {
    basics: [
      "Start with low-cost index funds for broad market exposure",
      "Diversify your investments across different asset classes",
      "Consider your risk tolerance and investment timeline",
      "Reinvest dividends to maximize compound growth",
      "Regular investing (SIP) can help manage market volatility"
    ],
    advanced: [
      "Research before investing in individual stocks",
      "Consider tax-efficient investment strategies",
      "Monitor and rebalance your portfolio periodically",
      "Don't try to time the market",
      "Keep some cash reserves for opportunities"
    ],
    risks: [
      "Never invest money you can't afford to lose",
      "Be wary of investment schemes promising unusually high returns",
      "Understand the risks before investing in cryptocurrencies",
      "Don't put all your eggs in one basket",
      "Consider consulting a financial advisor for large investments"
    ]
  },

  debtManagement: {
    reduction: [
      "List all debts with their interest rates",
      "Consider the snowball or avalanche method for debt repayment",
      "Look into balance transfer options for high-interest credit cards",
      "Try to pay more than the minimum payment",
      "Consider debt consolidation for multiple high-interest debts"
    ],
    prevention: [
      "Create and stick to a budget to avoid unnecessary debt",
      "Build an emergency fund to avoid debt for unexpected expenses",
      "Use credit cards responsibly and pay full balance when possible",
      "Research and compare before taking loans",
      "Avoid payday loans and high-interest debt"
    ],
    creditScore: [
      "Pay bills on time to maintain a good credit score",
      "Keep credit utilization below 30%",
      "Regularly check your credit report for errors",
      "Don't close old credit accounts unnecessarily",
      "Limit new credit applications"
    ]
  },

  taxPlanning: {
    deductions: [
      "Keep records of all tax-deductible expenses",
      "Maximize retirement account contributions for tax benefits",
      "Consider tax-saving investments under Section 80C",
      "Save healthcare receipts for medical deductions",
      "Look into deductions for education expenses"
    ],
    planning: [
      "Plan investments with tax efficiency in mind",
      "Consider tax implications before selling investments",
      "Keep up with changes in tax laws",
      "Consider consulting a tax professional",
      "Start tax planning early in the financial year"
    ]
  },

  financialGoals: {
    setting: [
      "Make your goals SMART: Specific, Measurable, Achievable, Relevant, Time-bound",
      "Break large financial goals into smaller milestones",
      "Write down your goals and review them regularly",
      "Adjust goals as your life circumstances change",
      "Share goals with accountability partners"
    ],
    tracking: [
      "Use this app's Savings Goals feature to track progress",
      "Review your goals monthly and adjust as needed",
      "Celebrate reaching milestones",
      "Learn from setbacks and adjust strategies",
      "Keep motivated by visualizing your progress"
    ]
  },

  insurance: {
    basics: [
      "Review your insurance coverage annually",
      "Consider life insurance if others depend on your income",
      "Don't underestimate the importance of health insurance",
      "Look into disability insurance for income protection",
      "Compare insurance quotes before purchasing"
    ],
    tips: [
      "Bundle insurance policies for discounts",
      "Maintain an emergency fund alongside insurance",
      "Understand your policy exclusions and limitations",
      "Keep beneficiary information updated",
      "Document valuable possessions for insurance claims"
    ]
  }
};

// Helper function to get random advice from a specific subcategory
export const getAdvice = (category, subcategory = null) => {
  try {
    // If subcategory is provided and exists
    if (subcategory && financeKnowledge[category][subcategory]) {
      const options = financeKnowledge[category][subcategory];
      return options[Math.floor(Math.random() * options.length)];
    }
    // Otherwise, get from general subcategory
    else if (financeKnowledge[category] && financeKnowledge[category].general) {
      const options = financeKnowledge[category].general;
      return options[Math.floor(Math.random() * options.length)];
    }
    // Get a random subcategory
    else if (financeKnowledge[category]) {
      const subcategories = Object.keys(financeKnowledge[category]);
      const randomSubcategory = subcategories[Math.floor(Math.random() * subcategories.length)];
      const options = financeKnowledge[category][randomSubcategory];
      return options[Math.floor(Math.random() * options.length)];
    }
  } catch (error) {
    console.error("Error retrieving advice:", error);
  }
  
  // Default response
  return "I don't have specific advice on that topic yet.";
};

// Function to detect subcategory from user input
export const detectSubcategory = (category, input) => {
  if (!financeKnowledge[category]) return null;
  
  const lowerInput = input.toLowerCase();
  const subcategories = Object.keys(financeKnowledge[category]);
  
  // Map of subcategory keywords
  const keywordMap = {
    // Budgeting subcategories
    methods: ['method', 'system', 'zero based', '50/30/20', 'envelope', 'pay yourself first', 'values'],
    challenges: ['challenge', 'difficult', 'problem', 'struggle', 'irregular', 'inconsistent', 'variable'],
    
    // Saving subcategories
    emergencyFund: ['emergency', 'fund', 'rainy day', 'unexpected', 'medical', 'job loss'],
    savingGoals: ['goal', 'target', 'save for', 'saving for', 'milestone'],
    savingTips: ['tips', 'tricks', 'ideas', 'strategies', 'how to save'],
    
    // Investing subcategories
    beginners: ['begin', 'start', 'new', 'beginner', 'first time', 'how to invest', 'just starting'],
    strategy: ['strategy', 'allocation', 'diversify', 'portfolio', 'risk', 'returns'],
    retirement: ['retire', '401', 'ira', 'pension', 'retirement account'],
    
    // Debt subcategories
    creditCard: ['credit card', 'card', 'cards', 'high interest', 'plastic'],
    studentLoans: ['student', 'loan', 'education', 'college', 'university'],
    mortgage: ['mortgage', 'house', 'home loan', 'property', 'real estate'],
    debtFree: ['debt free', 'freedom', 'paid off', 'no debt'],
    
    // Tax subcategories
    deductions: ['deduction', 'write off', 'tax break', 'reduce taxes'],
    taxPlanning: ['plan', 'strategy', 'reduce', 'minimize', 'tax efficient'],
    filing: ['file', 'filing', 'tax return', 'submit', 'irs'],
    
    // Retirement subcategories
    planning: ['plan', 'planning', 'how much', 'calculate', 'estimate'],
    accounts: ['account', '401k', 'ira', 'roth', 'traditional', 'pension'],
    lateStart: ['late', 'behind', 'catch up', 'older', '50s', '60s', 'soon'],
    
    // App help subcategories
    transactions: ['transaction', 'add', 'record', 'entry', 'input'],
    reporting: ['report', 'chart', 'graph', 'visualization', 'analysis'],
    categories: ['category', 'categorize', 'tag', 'label', 'group'],
    dataManagement: ['data', 'export', 'import', 'csv', 'backup'],

    savingsAdvice: {
      emergency: ['emergency', 'rainy day', 'unexpected'],
      retirement: ['retirement', 'pension', 'old age'],
      general: ['save', 'saving', 'savings']
    },

    investmentAdvice: {
      basics: ['start', 'begin', 'new', 'basic'],
      advanced: ['advanced', 'complex', 'strategy'],
      risks: ['risk', 'danger', 'warning']
    },

    debtManagement: {
      reduction: ['reduce', 'pay off', 'eliminate'],
      prevention: ['prevent', 'avoid', 'stop'],
      creditScore: ['credit score', 'credit rating', 'cibil']
    },

    taxPlanning: {
      deductions: ['deduction', 'write off', 'tax saving'],
      planning: ['plan', 'strategy', 'prepare']
    },

    financialGoals: {
      setting: ['set', 'create', 'start'],
      tracking: ['track', 'monitor', 'progress']
    },

    insurance: {
      basics: ['basic', 'start', 'need'],
      tips: ['tips', 'advice', 'suggest']
    }
  };
  
  // Check for subcategory keywords in the input
  for (const sub of subcategories) {
    // Skip 'general' as it's the default
    if (sub === 'general') continue;
    
    // Check direct mention of subcategory name
    if (lowerInput.includes(sub.toLowerCase())) {
      return sub;
    }
    
    // Check for related keywords
    const keywords = keywordMap[sub];
    if (keywords && keywords.some(keyword => lowerInput.includes(keyword))) {
      return sub;
    }
  }
  
  return null; // Default to null (will use general or random subcategory)
}; 